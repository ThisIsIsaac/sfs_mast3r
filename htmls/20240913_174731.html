<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Reconstruction Results Viewer</title>
    <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.159.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.159.0/examples/jsm/"
      }
    }
    </script>
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
        #results-container { display: flex; flex-wrap: wrap; justify-content: space-around; }
        .result-item { 
            width: 100%; 
            max-width: 600px; 
            margin: 10px; 
            padding: 10px; 
            border: 1px solid #ccc; 
            box-sizing: border-box;
        }
        .input-images { 
            display: flex; 
            justify-content: space-between; 
            height: 200px; 
            gap: 10px;
            margin-bottom: 10px;
        }
        .image-container {
            width: 48%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }
        .image-container img { 
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
        }
        .reconstruction-view { 
            width: 100%; 
            height: 300px; 
            position: relative;
        }
        #controls { 
            position: fixed; 
            top: 10px; 
            left: 10px; 
            background: rgba(255,255,255,0.8); 
            padding: 10px; 
            border-radius: 5px; 
            z-index: 1000;
        }
        #score-filter { margin-top: 10px; }
        #pagination { display: flex; justify-content: center; margin-top: 20px; }
        #pagination button { margin: 0 5px; }
    </style>
</head>
<body>
    <div id="controls">
        <label for="items-per-page">Items per page:</label>
        <input type="number" id="items-per-page" min="1" max="100" value="20">
        <div id="score-filter">
            <label for="min-score">Min Score:</label>
            <input type="number" id="min-score" step="0.01" value="0">
            <label for="max-score">Max Score:</label>
            <input type="number" id="max-score" step="0.01" value="1">
            <button id="apply-filter">Apply Filter</button>
        </div>
    </div>
    <div id="results-container"></div>
    <div id="pagination">
        <button id="prev-page">&lt; Previous</button>
        <span id="page-info"></span>
        <button id="next-page">Next &gt;</button>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
    
        // Mock data - replace this with your actual data loading mechanism
        const mockData = [
  {
    "id": 0,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_3530906.jpg",
    "reconstructionFile": "../mast3r_results/tmp6m_v8maj_scene.glb",
    "score": 1.0
  },
  {
    "id": 1,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_10162894.jpg",
    "reconstructionFile": "../mast3r_results/tmp08jmrhyi_scene.glb",
    "score": 0.342251181602478
  },
  {
    "id": 2,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_8888343.jpg",
    "reconstructionFile": "../mast3r_results/tmp_565w737_scene.glb",
    "score": 0.3661470413208008
  },
  {
    "id": 3,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_898063.jpg",
    "reconstructionFile": "../mast3r_results/tmprshmbcih_scene.glb",
    "score": 0.46535176038742065
  },
  {
    "id": 4,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_9088420.jpg",
    "reconstructionFile": "../mast3r_results/tmpz5ujen3t_scene.glb",
    "score": 0.3904982805252075
  },
  {
    "id": 5,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_3532761.jpg",
    "reconstructionFile": "../mast3r_results/tmpa6gguuje_scene.glb",
    "score": 0.5672243237495422
  },
  {
    "id": 6,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_1808627.jpg",
    "reconstructionFile": "../mast3r_results/tmppz1oqz56_scene.glb",
    "score": 0.5941051244735718
  },
  {
    "id": 7,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_559366.jpg",
    "reconstructionFile": "../mast3r_results/tmpaarfbs5b_scene.glb",
    "score": 0.5190901160240173
  },
  {
    "id": 8,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_2189626.jpg",
    "reconstructionFile": "../mast3r_results/tmpcg1tytmq_scene.glb",
    "score": NaN
  },
  {
    "id": 9,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_10319488.jpg",
    "reconstructionFile": "../mast3r_results/tmpynm8xpl6_scene.glb",
    "score": 0.14902913570404053
  },
  {
    "id": 10,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_9356183.jpg",
    "reconstructionFile": "../mast3r_results/tmps7oyk3q2_scene.glb",
    "score": NaN
  },
  {
    "id": 11,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_6823060.jpg",
    "reconstructionFile": "../mast3r_results/tmpiifc8_1j_scene.glb",
    "score": 0.34173884987831116
  },
  {
    "id": 12,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_3077039.jpg",
    "reconstructionFile": "../mast3r_results/tmpe757bzmq_scene.glb",
    "score": 0.4480665624141693
  },
  {
    "id": 13,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_1102421.jpg",
    "reconstructionFile": "../mast3r_results/tmpsianfx78_scene.glb",
    "score": 0.2694387435913086
  },
  {
    "id": 14,
    "inputImage1": "../mast3r_results/image_3530906.jpg",
    "inputImage2": "../mast3r_results/image_8205827.jpg",
    "reconstructionFile": "../mast3r_results/tmp3jpkjcjg_scene.glb",
    "score": 0.36641108989715576
  },
  {
    "id": 15,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_11215164.jpg",
    "reconstructionFile": "../mast3r_results/tmpaqwyqz9q_scene.glb",
    "score": 0.9999890327453613
  },
  {
    "id": 16,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_2699850.jpg",
    "reconstructionFile": "../mast3r_results/tmpigyfawa8_scene.glb",
    "score": 0.7937242984771729
  },
  {
    "id": 17,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_3061849.jpg",
    "reconstructionFile": "../mast3r_results/tmpo1jeaxyk_scene.glb",
    "score": 0.6612221598625183
  },
  {
    "id": 18,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_5455618.jpg",
    "reconstructionFile": "../mast3r_results/tmpdjc3nana_scene.glb",
    "score": 0.7262439131736755
  },
  {
    "id": 19,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_8654181.jpg",
    "reconstructionFile": "../mast3r_results/tmpxc6zcvtk_scene.glb",
    "score": 0.6568354368209839
  },
  {
    "id": 20,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_642062.jpg",
    "reconstructionFile": "../mast3r_results/tmptcbztu47_scene.glb",
    "score": 0.7651963233947754
  },
  {
    "id": 21,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_10638518.jpg",
    "reconstructionFile": "../mast3r_results/tmp0jl_j85o_scene.glb",
    "score": 0.7335044145584106
  },
  {
    "id": 22,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_4179770.jpg",
    "reconstructionFile": "../mast3r_results/tmppyowtcxu_scene.glb",
    "score": 0.6978393197059631
  },
  {
    "id": 23,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_3923153.jpg",
    "reconstructionFile": "../mast3r_results/tmpp3_8np_r_scene.glb",
    "score": 0.6783247590065002
  },
  {
    "id": 24,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_10629921.jpg",
    "reconstructionFile": "../mast3r_results/tmpekjotqx5_scene.glb",
    "score": 0.6390267610549927
  },
  {
    "id": 25,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_11192003.jpg",
    "reconstructionFile": "../mast3r_results/tmpiq2qgs7t_scene.glb",
    "score": 0.71700119972229
  },
  {
    "id": 26,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_8090548.jpg",
    "reconstructionFile": "../mast3r_results/tmpydf1sfkc_scene.glb",
    "score": 0.8086663484573364
  },
  {
    "id": 27,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_2780244.jpg",
    "reconstructionFile": "../mast3r_results/tmp94as42vu_scene.glb",
    "score": 0.7658671140670776
  },
  {
    "id": 28,
    "inputImage1": "../mast3r_results/image_11215164.jpg",
    "inputImage2": "../mast3r_results/image_7409894.jpg",
    "reconstructionFile": "../mast3r_results/tmpyizsfe0h_scene.glb",
    "score": 0.7136116623878479
  },
  {
    "id": 29,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_3539730.jpg",
    "reconstructionFile": "../mast3r_results/tmpabfqbpw__scene.glb",
    "score": 1.0
  },
  {
    "id": 30,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_9488824.jpg",
    "reconstructionFile": "../mast3r_results/tmpl415kdp9_scene.glb",
    "score": 0.7278661131858826
  },
  {
    "id": 31,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_3451133.jpg",
    "reconstructionFile": "../mast3r_results/tmpknpxvy9s_scene.glb",
    "score": 0.6712216734886169
  },
  {
    "id": 32,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_5420300.jpg",
    "reconstructionFile": "../mast3r_results/tmp73bzsqve_scene.glb",
    "score": 0.5363556742668152
  },
  {
    "id": 33,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_6685744.jpg",
    "reconstructionFile": "../mast3r_results/tmp8ns4nma3_scene.glb",
    "score": 0.536604642868042
  },
  {
    "id": 34,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_3695789.jpg",
    "reconstructionFile": "../mast3r_results/tmpo3zs6eid_scene.glb",
    "score": 0.5143405199050903
  },
  {
    "id": 35,
    "inputImage1": "../mast3r_results/image_3539730.jpg",
    "inputImage2": "../mast3r_results/image_6740305.jpg",
    "reconstructionFile": "../mast3r_results/tmppae452uk_scene.glb",
    "score": 0.5433477759361267
  },
  {
    "id": 36,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_7422314.jpg",
    "reconstructionFile": "../mast3r_results/tmp4hacd2xz_scene.glb",
    "score": 1.0
  },
  {
    "id": 37,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_3494025.jpg",
    "reconstructionFile": "../mast3r_results/tmpywqmgtui_scene.glb",
    "score": 0.5728703141212463
  },
  {
    "id": 38,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_8223017.jpg",
    "reconstructionFile": "../mast3r_results/tmptz6wkp4o_scene.glb",
    "score": 0.7435253262519836
  },
  {
    "id": 39,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_6929099.jpg",
    "reconstructionFile": "../mast3r_results/tmpl4b3ml3f_scene.glb",
    "score": 0.5790791511535645
  },
  {
    "id": 40,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_10187001.jpg",
    "reconstructionFile": "../mast3r_results/tmpat_gajfv_scene.glb",
    "score": 0.7121859192848206
  },
  {
    "id": 41,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_2830281.jpg",
    "reconstructionFile": "../mast3r_results/tmpatsi00z2_scene.glb",
    "score": 0.47186174988746643
  },
  {
    "id": 42,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_2463729.jpg",
    "reconstructionFile": "../mast3r_results/tmpyiglbjyh_scene.glb",
    "score": 0.657625138759613
  },
  {
    "id": 43,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_9830245.jpg",
    "reconstructionFile": "../mast3r_results/tmpqch9ypos_scene.glb",
    "score": 0.72955721616745
  },
  {
    "id": 44,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_3874957.jpg",
    "reconstructionFile": "../mast3r_results/tmpai633ssu_scene.glb",
    "score": NaN
  },
  {
    "id": 45,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_9912516.jpg",
    "reconstructionFile": "../mast3r_results/tmpq593tm_n_scene.glb",
    "score": 0.38298696279525757
  },
  {
    "id": 46,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_575733.jpg",
    "reconstructionFile": "../mast3r_results/tmpp1pvtze7_scene.glb",
    "score": 0.7349395751953125
  },
  {
    "id": 47,
    "inputImage1": "../mast3r_results/image_7422314.jpg",
    "inputImage2": "../mast3r_results/image_9560699.jpg",
    "reconstructionFile": "../mast3r_results/tmpcymvnbxe_scene.glb",
    "score": 0.4612491726875305
  },
  {
    "id": 48,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_7930540.jpg",
    "reconstructionFile": "../mast3r_results/tmpweos7ruk_scene.glb",
    "score": 1.0
  },
  {
    "id": 49,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_7522459.jpg",
    "reconstructionFile": "../mast3r_results/tmp9xzm3p34_scene.glb",
    "score": 0.34930750727653503
  },
  {
    "id": 50,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_10971088.jpg",
    "reconstructionFile": "../mast3r_results/tmp1e0t8iwt_scene.glb",
    "score": 0.5433993935585022
  },
  {
    "id": 51,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_4423564.jpg",
    "reconstructionFile": "../mast3r_results/tmpwme0zcnm_scene.glb",
    "score": 0.8288841843605042
  },
  {
    "id": 52,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_4702157.jpg",
    "reconstructionFile": "../mast3r_results/tmpiqfzm7to_scene.glb",
    "score": 0.3217223584651947
  },
  {
    "id": 53,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_10882738.jpg",
    "reconstructionFile": "../mast3r_results/tmpw1szz_ns_scene.glb",
    "score": 0.5994232296943665
  },
  {
    "id": 54,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_6228316.jpg",
    "reconstructionFile": "../mast3r_results/tmpjg95rgaj_scene.glb",
    "score": 0.7036185264587402
  },
  {
    "id": 55,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_915334.jpg",
    "reconstructionFile": "../mast3r_results/tmp3d5u7hdx_scene.glb",
    "score": 0.4394776225090027
  },
  {
    "id": 56,
    "inputImage1": "../mast3r_results/image_7930540.jpg",
    "inputImage2": "../mast3r_results/image_2047066.jpg",
    "reconstructionFile": "../mast3r_results/tmpbrc_1pph_scene.glb",
    "score": 0.7520071864128113
  },
  {
    "id": 57,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_6915446.jpg",
    "reconstructionFile": "../mast3r_results/tmpxkj7jpri_scene.glb",
    "score": 0.37592315673828125
  },
  {
    "id": 58,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_9598737.jpg",
    "reconstructionFile": "../mast3r_results/tmp5vxtrz66_scene.glb",
    "score": 0.56069415807724
  },
  {
    "id": 59,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_1490869.jpg",
    "reconstructionFile": "../mast3r_results/tmpshxkxb9x_scene.glb",
    "score": 0.7773779034614563
  },
  {
    "id": 60,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_5697081.jpg",
    "reconstructionFile": "../mast3r_results/tmphy5uakv2_scene.glb",
    "score": 0.6317850947380066
  },
  {
    "id": 61,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_3318526.jpg",
    "reconstructionFile": "../mast3r_results/tmpj_4obd9v_scene.glb",
    "score": 0.5757191181182861
  },
  {
    "id": 62,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_704175.jpg",
    "reconstructionFile": "../mast3r_results/tmpq6hnfzg4_scene.glb",
    "score": 0.19396905601024628
  },
  {
    "id": 63,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_12760522.jpg",
    "reconstructionFile": "../mast3r_results/tmpef25i1ql_scene.glb",
    "score": 0.7035393714904785
  },
  {
    "id": 64,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_2130401.jpg",
    "reconstructionFile": "../mast3r_results/tmpd4t7y75r_scene.glb",
    "score": 0.46145549416542053
  },
  {
    "id": 65,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_11353508.jpg",
    "reconstructionFile": "../mast3r_results/tmpw85pm1e__scene.glb",
    "score": 0.5648419260978699
  },
  {
    "id": 66,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_2852042.jpg",
    "reconstructionFile": "../mast3r_results/tmpn2uh7ge3_scene.glb",
    "score": 0.4031950831413269
  },
  {
    "id": 67,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_10224043.jpg",
    "reconstructionFile": "../mast3r_results/tmp3fwzrsyo_scene.glb",
    "score": 0.5069705843925476
  },
  {
    "id": 68,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_691123.jpg",
    "reconstructionFile": "../mast3r_results/tmpr7rq8oy8_scene.glb",
    "score": 0.6275796890258789
  },
  {
    "id": 69,
    "inputImage1": "../mast3r_results/image_4403960.jpg",
    "inputImage2": "../mast3r_results/image_1678859.jpg",
    "reconstructionFile": "../mast3r_results/tmp46h5bzui_scene.glb",
    "score": 0.6051719188690186
  },
  {
    "id": 70,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_4793997.jpg",
    "reconstructionFile": "../mast3r_results/tmp2i63ik3h_scene.glb",
    "score": 1.0
  },
  {
    "id": 71,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_8692591.jpg",
    "reconstructionFile": "../mast3r_results/tmp_7y78af0_scene.glb",
    "score": NaN
  },
  {
    "id": 72,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_3190742.jpg",
    "reconstructionFile": "../mast3r_results/tmprr7d0zev_scene.glb",
    "score": 0.4063836932182312
  },
  {
    "id": 73,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_2564827.jpg",
    "reconstructionFile": "../mast3r_results/tmpdtr8hm_0_scene.glb",
    "score": 0.34683483839035034
  },
  {
    "id": 74,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_8347362.jpg",
    "reconstructionFile": "../mast3r_results/tmpkaihmfr0_scene.glb",
    "score": 0.7124234437942505
  },
  {
    "id": 75,
    "inputImage1": "../mast3r_results/image_4793997.jpg",
    "inputImage2": "../mast3r_results/image_4036073.jpg",
    "reconstructionFile": "../mast3r_results/tmpnfm816o7_scene.glb",
    "score": 0.642839252948761
  }
];
    
        let currentPage = 1;
        let itemsPerPage = 20;
        let filteredData = [...mockData];
    
        const resultsContainer = document.getElementById('results-container');
        const itemsPerPageInput = document.getElementById('items-per-page');
        const minScoreInput = document.getElementById('min-score');
        const maxScoreInput = document.getElementById('max-score');
        const applyFilterButton = document.getElementById('apply-filter');
        const prevPageButton = document.getElementById('prev-page');
        const nextPageButton = document.getElementById('next-page');
        const pageInfo = document.getElementById('page-info');
    
        // Maps to keep track of renderers and observers
        const reconstructionRenderers = new Map(); // Map from item.id to renderer data
        const itemsMap = {}; // Map from item.id to item data
    
        function createResultItem(item) {
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';
            resultItem.innerHTML = `
                <div class="input-images">
                    <div class="image-container">
                        <img src="${item.inputImage1}" alt="Input 1">
                    </div>
                    <div class="image-container">
                        <img src="${item.inputImage2}" alt="Input 2">
                    </div>
                </div>
                <div class="reconstruction-view" id="reconstruction-${item.id}" data-id="${item.id}"></div>
                <p>Score: ${item.score.toFixed(2)}</p>
            `;
            return resultItem;
        }
    
        function loadResults() {
            resultsContainer.innerHTML = '';
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageItems = filteredData.slice(startIndex, endIndex);
    
            // Update itemsMap
            pageItems.forEach(item => {
                itemsMap[item.id] = item;
            });
    
            pageItems.forEach(item => {
                const resultItem = createResultItem(item);
                resultsContainer.appendChild(resultItem);
    
                // Observe the reconstruction view for visibility
                const reconstructionElement = resultItem.querySelector('.reconstruction-view');
                observer.observe(reconstructionElement);
            });
    
            updatePagination();
        }
    
        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
            prevPageButton.disabled = currentPage === 1;
            nextPageButton.disabled = currentPage === totalPages;
        }
    
        function initializeReconstruction(id, glbFile) {
            const container = document.getElementById(`reconstruction-${id}`);
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
    
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.enableZoom = true;
    
            const light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(1, 1, 1).normalize();
            scene.add(light);
    
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
    
            const loader = new GLTFLoader();
            let animationFrameId;
            loader.load(glbFile, (gltf) => {
                scene.add(gltf.scene);
    
                // Compute the bounding box of the model
                const box = new THREE.Box3().setFromObject(gltf.scene);
                const center = box.getCenter(new THREE.Vector3());
                const size = box.getSize(new THREE.Vector3());
                const maxDim = Math.max(size.x, size.y, size.z);
    
                // Center the model
                gltf.scene.position.sub(center);
    
                // Adjust camera position to fit the model
                const fov = camera.fov * (Math.PI / 180);
                let cameraZ = maxDim / (2 * Math.tan(fov / 2));
    
                cameraZ *= 1.5; // Adjust as needed to add some padding
    
                camera.position.set(0, 0, cameraZ);
                camera.lookAt(new THREE.Vector3(0, 0, 0));
    
                // Update controls
                controls.target.set(0, 0, 0);
                controls.update();
    
                function animate() {
                    animationFrameId = requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();
            }, undefined, (error) => {
                console.error('An error occurred while loading the GLB file:', error);
            });
    
            const resizeObserver = new ResizeObserver(() => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
            resizeObserver.observe(container);
    
            // Store references for disposal later
            reconstructionRenderers.set(id, {
                renderer,
                scene,
                camera,
                controls,
                resizeObserver,
                animationFrameId,
                container
            });
        }
    
        function disposeReconstruction(id) {
            const rendererData = reconstructionRenderers.get(id);
            if (rendererData) {
                const { renderer, scene, controls, resizeObserver, animationFrameId, container } = rendererData;
    
                // Cancel the animation frame
                cancelAnimationFrame(animationFrameId);
    
                // Dispose of the controls
                controls.dispose();
    
                // Dispose of the scene
                scene.traverse(function (object) {
                    if (!object.isMesh) return;
    
                    object.geometry.dispose();
    
                    if (object.material.isMaterial) {
                        cleanMaterial(object.material);
                    } else {
                        // an array of materials
                        for (const material of object.material) cleanMaterial(material);
                    }
                });
    
                function cleanMaterial(material) {
                    material.dispose();
    
                    // dispose textures
                    for (const key in material) {
                        const value = material[key];
                        if (value && typeof value === 'object' && 'minFilter' in value) {
                            value.dispose();
                        }
                    }
                }
    
                // Dispose of the renderer
                renderer.dispose();
    
                // Disconnect the resize observer
                resizeObserver.disconnect();
    
                // Remove the renderer's DOM element
                container.removeChild(renderer.domElement);
    
                // Remove from the map
                reconstructionRenderers.delete(id);
            }
        }
    
        // Intersection Observer to detect visibility
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1 // Adjust as needed
        };
    
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const id = entry.target.dataset.id;
                if (entry.isIntersecting) {
                    // Element is visible, initialize renderer if not already initialized
                    if (!reconstructionRenderers.has(id)) {
                        initializeReconstruction(id, itemsMap[id].reconstructionFile);
                    }
                } else {
                    // Element is not visible, dispose of renderer if exists
                    if (reconstructionRenderers.has(id)) {
                        disposeReconstruction(id);
                    }
                }
            });
        }, observerOptions);
    
        itemsPerPageInput.addEventListener('change', () => {
            itemsPerPage = parseInt(itemsPerPageInput.value);
            currentPage = 1;
            loadResults();
        });
    
        applyFilterButton.addEventListener('click', () => {
            const minScore = parseFloat(minScoreInput.value);
            const maxScore = parseFloat(maxScoreInput.value);
            filteredData = mockData.filter(item => item.score >= minScore && item.score <= maxScore);
            currentPage = 1;
            loadResults();
        });
    
        prevPageButton.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                loadResults();
            }
        });
    
        nextPageButton.addEventListener('click', () => {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                loadResults();
            }
        });
    
        // Initial load
        loadResults();
    </script>

</body>
</html>